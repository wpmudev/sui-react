import { Section, Preview, Snippet, Code } from "@wpmudev/sui-docs"
import { TableExample } from "./Example"
import { generalCode } from "../TabExamples.mdx"
import dedent from "dedent"

export const code = dedent`
import React, { useEffect, useState, Fragment } from "react"
import {
    Table,
    TableBody,
    TableCell,
    TableRow,
    TableHead,
} from "../../../src"
import { Tag } from "@wpmudev/sui-tag"
import { Button } from "@wpmudev/sui-button"

export const groupedRecords = [
	{
		id: 2,
		title: "Contact Us Form",
		tag: "Draft",
		submission: "April 21, 2022 10:30 am",
		group: "report",
		status: "info",
	},
	{
		id: 6,
		title: "Order Form",
		tag: "Published",
		submission: "April 25, 2022 2:00 pm",
		status: "success",
		group: "report",
		props: {
			isExpandable: true,
			expandableContent: (
				<Box>
					<BoxGroup isInline={false}>
						Lorem Ipsum is simply dummy text of the printing and typesetting
						industry. Lorem Ipsum has been the industry standard dummy text ever
						since the 1500s
					</BoxGroup>
				</Box>
			),
		},
	},
	{
		id: 7,
		title: "Support Request",
		tag: "Draft",
		submission: "April 26, 2022 4:45 pm",
		status: "info",
		group: "report",
		props: {
			isExpandable: true,
			expandableContent: (
				<Box>
					<BoxGroup isInline={false}>
						Lorem Ipsum is simply dummy text of the printing and typesetting
						industry. Lorem Ipsum has been the industry standard dummy text ever
						since the 1500s
					</BoxGroup>
				</Box>
			),
		},
	},
	{
		id: 8,
		title: "Contact Information",
		tag: "Draft",
		submission: "April 27, 2022 11:30 am",
		status: "info",
		group: "notification",
	},
	{
		id: 9,
		title: "Event Registration",
		tag: "Published",
		submission: "April 28, 2022 5:10 pm",
		status: "success",
		group: "report",
		props: {
			isExpandable: true,
			expandableContent: (
				<Box>
					<BoxGroup isInline={false}>
						Lorem Ipsum is simply dummy text of the printing and typesetting
						industry. Lorem Ipsum has been the industry standard dummy text ever
						since the 1500s
					</BoxGroup>
				</Box>
			),
		},
	},
	{
		id: 10,
		title: "Survey Form",
		tag: "Draft",
		submission: "April 29, 2022 9:50 am",
		status: "info",
		group: "notification",
	},
	{
		id: 11,
		title: "Product Feedback",
		tag: "Published",
		submission: "April 30, 2022 3:30 pm",
		status: "success",
		group: "notification",
		props: {
			isExpandable: true,
			expandableContent: (
				<Box>
					<BoxGroup isInline={false}>
						Lorem Ipsum is simply dummy text of the printing and typesetting
						industry. Lorem Ipsum has been the industry standard dummy text ever
						since the 1500s
					</BoxGroup>
				</Box>
			),
		},
	},
]

export const TableExample = ({ ...props }: Record<string, any>) => {
    const [rows, setRows] = useState<Record<string, any>[] | Record<string, any>>(
        [],
    )

    useEffect(() => {
        const groupedItems = groupedRecords.reduce(
            (result: Record<string, any>, currentItem: Record<string, any>) => {
                ;(result[currentItem.group] = result[currentItem.group] || []).push(
                    currentItem,
                )
                return result
            },
            {},
        )

        setRows(groupedItems)
    }, [])

    const action = (_id: string, content: React.ReactNode) => {
        return (
            <div
                style={{
                    alignItems: "center",
                    display: "flex",
                    justifyContent: "end",
                }}
            >
                <Button
                    icon="Edit"
                    colorScheme="black"
                    type="tertiary"
                    isSmall={true}
                    iconOnly={true}
                />
                <Button
                    icon="Settings"
                    colorScheme="black"
                    type="tertiary"
                    isSmall={true}
                    iconOnly={true}
                />
                {content}
            </div>
        )
    }

    const groupsIconsMapping: Record<string, any> = {
        report: "Reports",
        notification: "Email",
    }

    return (
        <Table {...props}>
            <TableHead>
                <TableRow actions={() => null}>
                    <TableCell
                        isHeading={true}
                        isSortable={false}
                        isPrimary={true}
                        id="id"
                    >
                        ID
                    </TableCell>
                    <TableCell isHeading={true} isSortable={true} id="title">
                        Form name
                    </TableCell>
                    <TableCell isHeading={true} id="tag" isSortable={true}>
                        Status
                    </TableCell>
                    <TableCell isHeading={true} id="submission" isSortable={true}>
                        Last Submission
                    </TableCell>
                </TableRow>
            </TableHead>
            <TableBody>
                {Object.entries(rows).map(([group, items]) => (
                        <Fragment key="group">
                            <TableRow isGroup={true}>
                                <TableCell icon={groupsIconsMapping[group]}>
                                    <strong>{group}</strong>
                                </TableCell>
                            </TableRow>
                            {items.map((record: Record<string, any>, index: number) => (
                                <TableRow
                                    key={index}
                                    id={record.id}
                                    isExpandable={record?.props?.isExpandable}
                                    expandableContent={record?.props?.expandableContent}
                                    status={record?.status}
                                    actions={({ id, content }) => action(id, content)}
                                >
                                    <TableCell>
                                        <strong>#{record.id}</strong>
                                    </TableCell>
                                    <TableCell isTrim={true}>
                                        <strong>{record.title}</strong>
                                    </TableCell>
                                    <TableCell>
                                        <Tag
                                            colorScheme={
                                                "Published" === record.tag ? "blue" : "default"
                                            }
                                        >
                                            {record.tag}
                                        </Tag>
                                    </TableCell>
                                    <TableCell>{record.submission}</TableCell>
                                </TableRow>
                            ))}
                        </Fragment>
                    ))}
            </TableBody>
        </Table>
    )
}
`

<Section
    border={true}
    style={{ paddingRight: 0, paddingLeft: 0 }}
>
    <p>Set the prop <Code small={true}>isDraggable=\{true\}</Code> to allow rows to be dragged </p>
    <Preview wrapper={true}>
    	<TableExample isGrouped={true} />
    </Preview>
    <Snippet language="js">{code}</Snippet>

</Section>
